<!-- @format -->

{% extends 'base.html' %} {% block css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/fiches.css') }}" type="text/css" media="all" />
{% endblock %} {% block content %}
<div class="fiches-container">
	<h2 class="section-title">Mes Paris</h2>

	{% if not fiches %}
	<div style="text-align: center; margin-top: 50px;">
		<p>Vous n'avez pas encore placé de paris.</p>
		<a href="{{ url_for('home') }}" class="btn-parier" style="display:inline-block; margin-top:15px; padding:10px 20px; background:#007bff; color:white; border-radius:5px; text-decoration:none;">Commencer à parier</a>
	</div>
	{% else %}
	<div class="fiches-list">
		{# On boucle sur le dictionnaire 'fiches' (regroupé par ID) #} {% for id_pari, info in fiches.items() %}
		<details class="pari-card">
			<summary>
				<div class="ticket-info">
					<span class="ticket-id">Ticket #{{ id_pari }}</span>
					<span class="ticket-date">{{ set_date(info.date) }}</span>
				</div>

				{# Détermination automatique de la classe du badge selon le statut #} {% set status_class = 'status-en-attente' %} {% if info.statut == 'gagné' %}{% set status_class = 'status-gagne' %} {% elif info.statut == 'perdu' %}{% set status_class = 'status-perdu' %}{% endif %}

				<span class="statut-badge statut-{{ info.statut.lower().replace(' ', '-').replace('é', 'e') if info.statut else 'indetermine' }}"> {{ info.statut if info.statut else 'Indéterminé' }} </span>
			</summary>

			<div class="details-content">
				{# Liste des sélections (matchs) dans ce ticket #} {% for sel in info.selections %}
				<div class="selection-item">
					<span class="match-name">{{ sel.equipe_a }} vs {{ sel.equipe_b }}</span>
					<div class="option-details">Pronostic : <strong>{{ sel.option }}</strong> | Cote : <span class="cote-badge">{{ sel.cote }}</span></div>
				</div>
				{% endfor %}

				<div class="fiche-totals">
					<div class="total-row">
						<span>Mise totale :</span>
						<strong>{{ info.mise | devise }}</strong>
					</div>
					<div class="total-row">
						<span>Gain :</span>
						<span class="gain-potentiel">{{ info.gain | devise }}</span>
					</div>
				</div>
			</div>
		</details>
		{% endfor %}
	</div>
	{% endif %}
</div>
{% endblock %}
