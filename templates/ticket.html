{% extends "base.html" %} {% block head %}<link rel="stylesheet" href="{{ url_for('static', filename='css/ticket.css') }}" /><title>InterPam - Tickets</title>{% endblock %} {% block content %}<div class="ticket-container">    <h2 class="ticket-title">        Mon Ticket        <span class="status-badge status-en-attente">{{ selections|length }} sélection(s)</span>    </h2>    {% if selections %}    <div class="ticket-list">        {% for sel in selections %}        <div class="ticket-item">            <div class="match-info">                <div class="match-teams">{{ sel.equipe_a }} vs {{ sel.equipe_b }}</div>                <div class="bet-choice">                    {{ sel.categorie|replace('_', ' ') }} :                    <strong>{{ sel.libelle }}</strong>                </div>                <div class="date-match">Date : {{ set_date(sel.date_match) }}</div>            </div>            <div class="selection-right">                <span class="cote-badge">{{ sel.cote }}</span>                <a href="{{ url_for('supprimer_du_ticket', match_id=sel.match_id) }}" class="btn-delete">Retirer</a>            </div>        </div>        {% endfor %}    </div>    <div class="ticket-summary">        <div class="summary-row">            <span>Cote Totale</span>            <span class="cote-totale">{{ cote_totale }}</span>        </div>        <form action="{{ url_for('valider_ticket') }}" method="POST">            <input type="hidden" name="token" id="token" value="{{ token }}" />            <div class="same-line">                <div class="mise-section">                    <label class="mise-label">Votre Engagement (PMC)</label>                    <input type="number" name="mise" id="mise-input" placeholder="Min. 10 PMC" required step="0.01" value="{{ request.form.mise }}" />                </div>                <div class="gain-section">                    Jetons Potentiels :                    <br />                    <strong id="gain-estime">                        <span id="gain">{{ format_money(0) }}</span>                        PMC                    </strong>                </div>            </div>            <div class="mise_info" style="font-style: italic; text-align: center; justify-content: center; margin-bottom: 10px">                <p>Minimum : {{ format_money(config_global.mise_min) }} PMC</p>                <p>Maximun : {{ format_money(config_global.mise_max) }} PMC</p>            </div>            <button type="submit" class="btn-valider">VALIDER LE PRONOSTIC</button>        </form>        <div class="vider_ticket"><a href="{{ url_for('vider_ticket') }}">Vider le ticket</a></div>    </div>    <script>        const miseInput = document.getElementById('mise-input');        const gainDisplay = document.getElementById('gain');        const cote = {{ cote_totale }}; // Récupéré depuis le contexte Flask        /** * Formate le montant :         * - Ajoute des espaces pour les milliers         * - Affiche 2 décimales SI elles sont différentes de .00         * - Retire la virgule et les zéros si c'est un nombre entier         */                function formatMoneyJS(valeur) {            if (valeur === 0) return "0";            // On formate d'abord avec maximum 2 décimales                    let formatted = valeur.toLocaleString('fr-FR', {                minimumFractionDigits: 0,                maximumFractionDigits: 2            });            // Remplace l'espace insécable (standard toLocaleString) par un espace normal                    return formatted.replace(/\u00a0/g, ' ');        }        miseInput.addEventListener('input', function() {            let mise = parseFloat(this.value);            if (isNaN(mise)) mise = 0;            let gain = mise * cote;            // Mise à jour du texte avec le nouveau formatage                    gainDisplay.textContent = formatMoneyJS(gain);        });    </script>    {% else %}    <div class="empty-ticket">        <p>Votre ticket est actuellement vide.</p>        <a href="{{ url_for('home') }}" class="btn-return">Parcourir les matchs</a>    </div>    {% endif %}</div>{% endblock %}